!function(e){function t(e,t){d(e,e.find(".dd-option-value[value= '"+t+"']").parents("li").prevAll().length,!1)}function d(e,t,d){var i=e.data("ddslick"),s=e.find(".dd-selected"),l=s.siblings(".dd-selected-value"),a=(e.find(".dd-options"),s.siblings(".dd-pointer"),e.find(".dd-option").eq(t)),c=a.closest("li"),r=i.settings,p=i.settings.data[t];e.find(".dd-option").removeClass("dd-option-selected"),a.addClass("dd-option-selected");var f=i.selectedIndex!=t;i.selectedIndex=t,i.selectedItem=c,i.selectedData=p,r.showSelectedHTML?s.html((p.imageSrc?'<img class="dd-selected-image'+("right"==r.imagePosition?" dd-image-right":"")+'" src="'+p.imageSrc+'" />':"")+(p.text?'<label class="dd-selected-text">'+p.text+"</label>":"")+(p.description?'<small class="dd-selected-description dd-desc'+(r.truncateDescription?" dd-selected-description-truncated":"")+'" >'+p.description+"</small>":"")):s.html(p.text),l.val(p.value),i.original.val(p.value),e.data("ddslick",i),n(e),o(e),"function"==typeof r.onSelected&&r.onSelected.call(this,i),"function"==typeof r.onClick&&void 0===d&&r.onClick.call(this,i),"function"==typeof r.onChange&&0==d&&f&&r.onChange.call(this,i)}function i(t){var d=t.find(".dd-select"),i=d.siblings(".dd-options"),n=d.find(".dd-pointer"),o=i.is(":visible");e(".dd-click-off-close").not(i).slideUp(50),e(".dd-pointer").removeClass("dd-pointer-up"),d.removeClass("dd-open"),o?(i.slideUp("fast"),n.removeClass("dd-pointer-up"),d.removeClass("dd-open")):(d.addClass("dd-open"),i.slideDown("fast"),n.addClass("dd-pointer-up")),s(t)}function n(e){e.find(".dd-select").removeClass("dd-open"),e.find(".dd-options").slideUp(50),e.find(".dd-pointer").removeClass("dd-pointer-up").removeClass("dd-pointer-up")}function o(e){var t=e.find(".dd-select").css("height"),d=e.find(".dd-selected-description"),i=e.find(".dd-selected-image");d.length<=0&&i.length>0&&e.find(".dd-selected-text").css("lineHeight",t)}function s(t){t.find(".dd-option").each(function(){var d=e(this),i=d.css("height"),n=d.find(".dd-option-description"),o=t.find(".dd-option-image");n.length<=0&&o.length>0&&d.find(".dd-option-text").css("lineHeight",i)})}e.fn.ddslick=function(t){return l[t]?l[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?void e.error("Method "+t+" does not exists."):l.init.apply(this,arguments)};var l={},a={data:[],keepJSONItemsOnTop:!1,width:260,height:null,background:"#eee",selectText:"",defaultSelectedIndex:null,truncateDescription:!0,imagePosition:"left",showSelectedHTML:!0,clickOffToClose:!0,embedCSS:!0,imageMaxWidth:"64px",imageMarginRight:"5px",onSelected:function(){},onClick:function(){},onChange:function(){},onOpen:function(){},onClose:function(){},onDestroy:function(){},onInit:function(){}},c="";l.init=function(t){var n=e.extend({},a,t);return e("#css-ddslick").length<=0&&n.embedCSS&&(c='<style id="css-ddslick" type="text/css">.dd-select{ border-radius:2px; border:solid 1px #ccc; position:relative; cursor:pointer;}.dd-desc { color:#aaa important; display:block; overflow: hidden; font-weight:normal; line-height: 1.4em; }.dd-selected{ overflow:hidden; display:block; padding:10px; font-weight:bold;}.dd-pointer{ width:0; height:0; position:absolute; right:10px; top:50%; margin-top:-3px;}.dd-pointer-down{ border:solid 5px transparent; border-top:solid 5px #000; }.dd-pointer-up{border:solid 5px transparent !important; border-bottom:solid 5px #000 !important; margin-top:-8px;}.dd-options{ border:solid 1px #ccc; border-top:none; list-style:none; box-shadow:0px 1px 5px #ddd; display:none; position:absolute; z-index:2000; margin:0; padding:0;background:#fff; overflow:auto;}.dd-option{ padding:10px; display:block; border-bottom:solid 1px #ddd; overflow:hidden; text-decoration:none; color:#333; cursor:pointer;-webkit-transition: all 0.25s ease-in-out; -moz-transition: all 0.25s ease-in-out;-o-transition: all 0.25s ease-in-out;-ms-transition: all 0.25s ease-in-out; }.dd-options > li:last-child > .dd-option{ border-bottom:none;}.dd-option:hover{ background:#f3f3f3; color:#000;}.dd-selected-description-truncated { text-overflow: ellipsis; white-space:nowrap; }.dd-option-selected { background:#f6f6f6; }.dd-option-image, .dd-selected-image { vertical-align:middle; float:left; margin-right:'+n.imageMarginRight+"; max-width:"+n.imageMaxWidth+";}.dd-image-right { float:right; margin-right:15px; margin-left:5px;}.dd-container{ position:relative;}​ .dd-selected-text { font-weight:bold}​</style>",e(c).appendTo("head")),this.each(function(){var n=e.extend({},a,t),o=e(this);if(!o.data("ddslick")){c=[],n.data;o.find("option").each(function(){var t=e(this),d=t.data();c.push({text:e.trim(t.text()),value:t.val(),selected:t.is(":selected"),description:d.description,imageSrc:d.imagesrc})}),n.keepJSONItemsOnTop?e.merge(n.data,c):n.data=e.merge(c,n.data);var s=o,l=e("<div>").attr("id",o.attr("id")+"-dd-placeholder");o.replaceWith(l),(o=l).addClass("dd-container").append('<div class="dd-select"><input class="dd-selected-value" type="hidden" /><a class="dd-selected"></a><span class="dd-pointer dd-pointer-down"></span></div>').append('<ul class="dd-options"></ul>'),o.find("input.dd-selected-value").attr("id",e(s).attr("id")).attr("name",e(s).attr("name"));var c=o.find(".dd-select"),r=o.find(".dd-options");c.css({width:n.width,background:n.background}),r.css({width:c.css("width")}),o.css({width:n.width}),null!=n.height&&r.css({height:n.height,overflow:"auto"}),e.each(n.data,function(e,t){t.selected&&(n.defaultSelectedIndex=e),r.append('<li><a class="dd-option">'+(t.value?' <input class="dd-option-value" type="hidden" value="'+t.value+'" />':"")+(t.imageSrc?' <img class="dd-option-image'+("right"==n.imagePosition?" dd-image-right":"")+'" src="'+t.imageSrc+'" />':"")+(t.text?' <label class="dd-option-text">'+t.text+"</label>":"")+(t.description?' <small class="dd-option-description dd-desc">'+t.description+"</small>":"")+"</a></li>")});var p={settings:n,original:s,selectedIndex:-1,selectedItem:null,selectedData:null};if(o.data("ddslick",p),n.selectText.length>0&&null==n.defaultSelectedIndex)o.find(".dd-selected").html(n.selectText);else{var f=null!=n.defaultSelectedIndex&&n.defaultSelectedIndex>=0&&n.defaultSelectedIndex<n.data.length?n.defaultSelectedIndex:0;d(o,f,!0)}o.find(".dd-select").on("click.ddslick",function(){i(o)}),o.find(".dd-option").on("click.ddslick",function(){d(o,e(this).closest("li").index(),!1)}),n.clickOffToClose&&(r.addClass("dd-click-off-close"),o.on("click.ddslick",function(e){e.stopPropagation()}),e("body").on("click",function(){e(".dd-open").removeClass("dd-open"),e(".dd-click-off-close").slideUp(50).siblings(".dd-select").find(".dd-pointer").removeClass("dd-pointer-up")}))}"function"==typeof p.settings.onInit&&p.settings.onInit.call(this,p)})},l.select=function(i){return this.each(function(){void 0!==i.index&&d(e(this),i.index,!1),i.id&&t(e(this),i.id)})},l.open=function(){return this.each(function(){var t=e(this),d=t.data("ddslick");d&&i(t),"function"==typeof d.settings.onOpen&&d.settings.onOpen.call(this,d)})},l.close=function(){return this.each(function(){var t=e(this),d=t.data("ddslick");d&&n(t),"function"==typeof d.settings.onClose&&d.settings.onClose.call(this,d)})},l.destroy=function(){return this.each(function(){var t=e(this),d=t.data("ddslick");if(d){var i=d.original;t.removeData("ddslick").unbind(".ddslick").replaceWith(i)}"function"==typeof d.settings.onDestroy&&d.settings.onDestroy.call(this,d)})}}(jQuery);
